import pandas as pd
import os
from os.path import isfile, join
from pathlib import Path

main_dir = '/Users/elianna.kondylis/output_combined/rra'
os.chdir(main_dir)

onlyfiles = [f for f in os.listdir('.') if isfile(join(".", f))]

dict1 = {'Kulsuptrakul':['HAV'], 'Marceau': ['DENV', 'HCV'], 'Wang': ['SARS-CoV2', '229E', 'OC43']}

df_list = list()
author_list = list()
virus_list = list()

for file in onlyfiles:
        if 'gene_summary' in file and file.endswith('.txt'):
            for author in dict1:
                for virus in dict1[author]:
                    if virus in file:
                        if virus == ' 229E' or virus == 'OC43':
                            virus = 'HCoV-' + virus
                        df1 = pd.read_csv(file)
                        df1['Virus'] = virus
                        df1['Author'] = author
                        df_list.append(df1)
                        
final_table = pd.concat(df_list)
print(final_table)

final_table.to_csv('/Users/elianna.kondylis/Desktop/out3.csv')
